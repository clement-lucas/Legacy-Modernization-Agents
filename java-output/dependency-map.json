{
  "dependencies": [
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DCOVERAG.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "FLDRIVR1.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CUSTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "AGNTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    }
  ],
  "copybookUsage": {
    "DBDRIVR1.cbl": [
      "SQLCA.cpy",
      "DPOLICY.cpy",
      "DCOVERAG.cpy",
      "DTRAKING.cpy"
    ],
    "DBDRIVR2.cbl": [
      "SQLCA.cpy",
      "DTRAKING.cpy"
    ],
    "FLDRIVR1.cbl": [
      "CAGENT.cpy"
    ],
    "FLDRIVR2.cbl": [],
    "MAINPGM.cbl": [
      "CPOLICY.cpy",
      "CAGENT.cpy",
      "CUSTNTFY.cpy",
      "AGNTNTFY.cpy"
    ]
  },
  "reverseDependencies": {
    "SQLCA.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "DPOLICY.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DCOVERAG.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DTRAKING.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "CAGENT.cpy": [
      "FLDRIVR1.cbl",
      "MAINPGM.cbl"
    ],
    "CPOLICY.cpy": [
      "MAINPGM.cbl"
    ],
    "CUSTNTFY.cpy": [
      "MAINPGM.cbl"
    ],
    "AGNTNTFY.cpy": [
      "MAINPGM.cbl"
    ]
  },
  "mermaidDiagram": "graph TB\n  %% Styles\n  classDef program fill:#1f77b4,stroke:#0e3c5e,stroke-width:2px,color:#fff;\n  classDef copybook fill:#ffdb58,stroke:#bfa600,stroke-width:2px,color:#333;\n  classDef subgraphBg fill:#f5f5f5,stroke:#bbb,stroke-width:1px;\n\n  %% Programs Subgraph\n  subgraph COBOL Programs\n    direction TB\n    DBDRIVR1[\u0022DBDRIVR1.cbl\u0022]\n    DBDRIVR2[\u0022DBDRIVR2.cbl\u0022]\n    FLDRIVR1[\u0022FLDRIVR1.cbl\u0022]\n    FLDRIVR2[\u0022FLDRIVR2.cbl\u0022]\n    MAINPGM[\u0022MAINPGM.cbl\u0022]\n  end\n  class DBDRIVR1,DBDRIVR2,FLDRIVR1,FLDRIVR2,MAINPGM program;\n  class COBOL Programs subgraphBg;\n\n  %% Copybooks Subgraph\n  subgraph Copybooks\n    direction TB\n    SQLCA[\u0022SQLCA.cpy\u0022]\n    DPOLICY[\u0022DPOLICY.cpy\u0022]\n    DCOVERAG[\u0022DCOVERAG.cpy\u0022]\n    DTRAKING[\u0022DTRAKING.cpy\u0022]\n    CAGENT[\u0022CAGENT.cpy\u0022]\n    CPOLICY[\u0022CPOLICY.cpy\u0022]\n    CUSTNTFY[\u0022CUSTNTFY.cpy\u0022]\n    AGNTNTFY[\u0022AGNTNTFY.cpy\u0022]\n  end\n  class SQLCA,DPOLICY,DCOVERAG,DTRAKING,CAGENT,CPOLICY,CUSTNTFY,AGNTNTFY copybook;\n  class Copybooks subgraphBg;\n\n  %% Dependencies\n  DBDRIVR1 --\u003E|COPY| SQLCA\n  DBDRIVR1 --\u003E|COPY| DPOLICY\n  DBDRIVR1 --\u003E|COPY| DCOVERAG\n  DBDRIVR1 --\u003E|COPY| DTRAKING\n\n  DBDRIVR2 --\u003E|COPY| SQLCA\n  DBDRIVR2 --\u003E|COPY| DTRAKING\n\n  FLDRIVR1 --\u003E|COPY| CAGENT\n\n  MAINPGM --\u003E|COPY| CPOLICY\n  MAINPGM --\u003E|COPY| CAGENT\n  MAINPGM --\u003E|COPY| CUSTNTFY\n  MAINPGM --\u003E|COPY| AGNTNTFY",
  "analysisInsights": "**COBOL Dependency Analysis**\n\n### 1. Data Flow Dependencies Between Copybooks\n\n#### Observed Copybook Usage:\n\n- **DBDRIVR1.cbl**:  \n  - \u0060SQLCA.cpy\u0060 (SQL communication area, likely for DB status)  \n  - \u0060DPOLICY.cpy\u0060  \n  - \u0060DCOVERAG.cpy\u0060  \n  - \u0060DTRAKING.cpy\u0060  \n\n- **DBDRIVR2.cbl**:  \n  - \u0060SQLCA.cpy\u0060  \n  - \u0060DTRAKING.cpy\u0060  \n\n- **FLDRIVR1.cbl**:  \n  - \u0060CAGENT.cpy\u0060  \n\n- **FLDRIVR2.cbl**:  \n  - *(No copybooks used)*  \n\n- **MAINPGM.cbl**:  \n  - \u0060CPOLICY.cpy\u0060  \n  - \u0060CAGENT.cpy\u0060  \n  - \u0060CUSTNTFY.cpy\u0060  \n  - \u0060AGNTNTFY.cpy\u0060  \n\n#### Data Flow Insights:\n\n- **DBDRIVR1/2** are database drivers, sharing \u0060SQLCA.cpy\u0060 and \u0060DTRAKING.cpy\u0060.  \n  - **Shared Data**: Likely transaction tracking via \u0060DTRAKING.cpy\u0060.\n  - **DBDRIVR1** is more complex, also using policy and coverage copybooks.\n\n- **FLDRIVR1** uses only \u0060CAGENT.cpy\u0060, suggesting focus on agent data.\n\n- **MAINPGM** is the main orchestrator, using policy, agent, and notification copybooks.\n  - **Shared Data**: \u0060CAGENT.cpy\u0060 is used by both \u0060FLDRIVR1\u0060 and \u0060MAINPGM\u0060, indicating agent data flows between these modules.\n\n- **No direct copybook overlap** between DB and FL drivers, except possibly via MAINPGM.\n\n### 2. Potential Circular Dependencies\n\n- **No explicit circular dependencies** in copybook usage:\n  - Each program includes copybooks, but copybooks are not shown to include other copybooks.\n  - If copybooks themselves include other copybooks, circularity could arise, but not indicated here.\n\n- **Indirect circularity risk**: If, for example, \u0060CAGENT.cpy\u0060 includes \u0060CPOLICY.cpy\u0060, and vice versa, but this is not shown.\n\n### 3. Modularity Recommendations\n\n- **Separation of Concerns**:\n  - Database drivers (\u0060DBDRIVR1/2\u0060) and file drivers (\u0060FLDRIVR1/2\u0060) are well separated by copybook usage.\n  - MAINPGM orchestrates, but shares copybooks with FLDRIVR1 (\u0060CAGENT.cpy\u0060).\n\n- **Reduce Copybook Overlap**:\n  - If possible, split large copybooks into smaller, more focused ones (e.g., agent address vs. agent contact info).\n  - Avoid monolithic copybooks that serve multiple unrelated modules.\n\n- **Encapsulate Shared Data**:\n  - If \u0060DTRAKING.cpy\u0060 is used for transaction tracking, consider isolating tracking logic into a service module, rather than sharing raw data structures.\n\n- **Document Copybook Interfaces**:\n  - Clearly document what each copybook provides, and who should use it.\n\n### 4. Legacy Patterns Affecting Dependencies\n\n- **Monolithic Copybooks**:\n  - Large, all-encompassing copybooks (e.g., \u0060CAGENT.cpy\u0060, \u0060CPOLICY.cpy\u0060) can create tight coupling and make refactoring difficult.\n\n- **Global Data Areas**:\n  - Use of global copybooks for communication (e.g., \u0060SQLCA.cpy\u0060) is typical in legacy COBOL, but can obscure data flow and increase risk of unintended side effects.\n\n- **Lack of Modularization**:\n  - Legacy code often lacks modular boundaries, leading to programs including more copybooks than necessary.\n\n- **Notification Copybooks**:\n  - \u0060CUSTNTFY.cpy\u0060, \u0060AGNTNTFY.cpy\u0060 suggest notification logic is handled via shared data areas, rather than modular procedures.\n\n---\n\n## **Summary \u0026 Recommendations**\n\n**Dependency Structure:**\n- Programs are reasonably modular, with database and file drivers separated.\n- MAINPGM is the central orchestrator, sharing agent data with FLDRIVR1.\n- No circular dependencies are apparent, but risk exists if copybooks include each other.\n\n**Recommendations:**\n1. **Audit Copybooks** for unnecessary inclusions and split large copybooks into smaller, purpose-specific ones.\n2. **Encapsulate Shared Logic** (e.g., tracking, notification) into service modules or subprograms, not just shared data areas.\n3. **Document Copybook Interfaces** and usage to prevent accidental coupling.\n4. **Modernize Data Flow** by reducing reliance on global data areas and favoring parameter passing or modular calls.\n\n**Legacy Patterns to Address:**\n- Large, monolithic copybooks.\n- Overuse of global data areas.\n- Lack of modular notification and tracking logic.\n\n**Overall:**  \nThe project shows reasonable separation, but legacy patterns (large copybooks, global data) could hinder maintainability and modularity. Refactoring copybooks and encapsulating shared logic will improve dependency management and future extensibility.",
  "metrics": {
    "totalPrograms": 5,
    "totalCopybooks": 7,
    "totalDependencies": 11,
    "averageDependenciesPerProgram": 2.2,
    "mostUsedCopybook": "SQLCA.cpy",
    "mostUsedCopybookCount": 2,
    "circularDependencies": []
  },
  "createdAt": "2025-11-12T13:42:57.6953407Z"
}